<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>Geeklog Documentation - Theme How-To</title>
  <link rel="stylesheet" type="text/css" href="docstyle.css" title="Dev Stylesheet">
</head>

<body>
<table cellpadding="2" cellspacing="2" border="0" width="100%">
<tr>
  <td valign="top"><img src="images/newlogo.gif" alt="Geeklog Documentation" width="235" height="90" border="0"></td>
</tr>
<tr>
  <td valign="top" class="menu"><a href="index.html">Geeklog Documentation</a> - Theme How-To</td>
</tr>
</table>

<h1>Creating a Theme for Geeklog</h1>

<p>Creating a theme for Geeklog is easy and quite fast. If you can
manipulate HTML files then you can create a theme! There's no need to learn
PHP.

<h2>Creating a theme</h2>

<p>First, copy an existing theme that is most similar to what you want to
implement (if one exists). If what you will do is radically different (and
we hope so!) then copying any one will do. Copy the existing theme to the
name you want your theme to have (please, <em>no</em> spaces in the theme name):

<p><kbd>cp -R /path/to/geeklog/public_html/layout/Yahoo /path/to/geeklog/public_html/layout/My_Theme_Name_No_Spaces</kbd>

<p>Change into your new theme directory:

<p><kbd>cd /path/to/geeklog/public_html/layout/My_Theme_Name_No_Spaces</kbd>

<p>Now edit the templates to suit your needs. Keep in mind that templates,
generally are partial HTML files. The directory you just created holds ALL
templates Geeklog needs but you will only need to modify a small few to
make a huge impact on the look.

<p>In particular these are the templates you will undoubtedly want to
change:

<ul>
<li>header.thtml
<li>footer.thtml
<li>blockheader.thtml
<li>blockfooter.thtml
<li>storybody.thtml
<li>storybodytext.thtml
<li>featuredstorybody.thtml
<li>featuredstorybodytext.thtml
<li>style.css
</ul>

<h3>How themes work</h3>

<p>When rendering a theme, Geeklog starts with <tt>header.thtml</tt> which
builds the site's header and then goes on to include the left column of blocks
(look for the variable {left_blocks} and the <tt>leftblocks.thtml</tt> file).
The middle part of a site consists of the stories which are built using the
<tt>storytext.thtml</tt> and <tt>storybodytext.thtml</tt> (for normal stories)
and <tt>featuredstorytext.thtml</tt> and <tt>featuredstorybodytext.thtml</tt>
(for featured stories) template files. The <tt>footer.thtml</tt> file then
builds the right column of blocks (variable {right_blocks}, file 
<tt>right_blocks.thtml</tt>) and the site's footer. Blocks themselves consist 
of the <tt>blockheader.thtml</tt> and <tt>blockfooter.thtml</tt> files.

<p>The above only described how Geeklog's main page and stories are rendered.
More templates exist for the various editors and lists you will see in Geeklog,
as well as for the calendar and almost every other part of Geeklog.</p>

<p>There is currently no complete list available that explains which template
file is used for which part of Geeklog. However, in most cases the use should
be obvious when you have a look at the file and directory names in your theme's
layout directory. If you're unsure which template file is used to render a
certain part of Geeklog, have a look at the URL. You will notice the name of
a PHP file there, e.g. the <tt>users.php</tt> file when you view a user's
profile. Open that file and search for '<kbd>.thtml</kbd>'. For the profile
you will find these lines (in <code>function userprofile()</code>):</p>
<blockquote><code>
    $user_templates = new Template ($_CONF['path_layout'] . 'users');<br>
    $user_templates->set_file (array ('profile'=>'profile.thtml', 'row'=>'commentrow.thtml', 'strow'=>'storyrow.thtml'));
</code></blockquote>
<p>You don't need to understand PHP code to see that this uses the template
files <tt>profile.thtml</tt>, <tt>commentrow.thtml</tt>, and
<tt>storyrow.thtml</tt>. The first line also indicates that these are taken
from the <tt>users</tt> directory within the theme's layout directory.</p>

<h3>Testing a theme and further information</h3>

<p>After you have edited your themes, you are now ready to test it out.
Simply go to http://mygeeklogsite/users.php?mode=preferences - in the theme
drop-down select your newly created theme (note the name of your theme is
the <em>same</em> name as the directory for your theme).

<p>Finally, you may want to update the logo and other images in your
theme's images directory.

<p>For the template system we are using PHPLib's template class (<a 
href="http://phplib.sourceforge.net/">http://phplib.sourceforge.net/</a>). 
Read their documentation and, optionally, look at 
/path/to/geeklog/system/classes/template.class.php to see how it is 
implemented. Even with this knowledge it may not be clear which templates 
are used in conjunction with one another (i.e. <tt>storybody.thtml</tt> and 
<tt>storybodytext.thtml</tt> together make up the complete format of a 
<em>single</em>
story). If you have questions join our mailing list at our SourceForge site 
at <a 
href="http://sourceforge.net/projects/geeklog">http://sourceforge.net/projects/geeklog</a> 
or check us out in IRC at irc.freenode.net in #geeklog.</p>

<h3>Tips and tricks</h4>

<p><strong>Themes and WYSIWG editors:</strong>
The template files used by Geeklog are not complete HTML files - they contain
only parts of the HTML that Geeklog puts together to build a proper HTML
document. This, however, seems to confuse some WYSIWYG HTML editors and some of
them tend to add the HTML which they think is missing from the file, thus
making it unusable for Geeklog.<br>
We suggest you use a simple text editor to edit your themes.</p>

<p><strong>PHP in themes:</strong>
You can use PHP in the <em>header</em> of a theme, i.e. in the
<tt>header.thtml</tt> file. If you want to use custom PHP functions, you can
put them in the file <tt>functions.php</tt> within your themes directory.</p>

<p><strong>Different look for left and right blocks:</strong>
You can give the blocks on the left and right a different look. See 
<a href="http://geeklog.sourceforge.net/article.php?story=20020429092841722">this story on the Geeklog homepage</a> for details.</p>


<h2><a name="changes">Theme changes in Geeklog 1.3.6</a></h2>

<p>There have been a lot of changes in the themes for 1.3.6 to get rid of the
last pieces of hard-coded english texts so as to make localisation easier.
Most of these changes have been made in the Admin editors (<tt>admin</tt> 
directory) and the calendar (<tt>calendar</tt> directory). If you created
your own theme for an earlier version of Geeklog, we recommend that you copy
over these two directories from one of the themes that come with Geeklog
(choose one that is similar to your own theme or which it was originally based
on). It seems like most Geeklog themes didn't change these files anyway, so
this shouldn't be too much of a hassle ...</p>

<h3>Other changes</h3>
<ul>
  <li>The template file <tt>admin/mail/mailform.thtml</tt> has been added.
    This form for sending emails to other users of the site was previously
    hard-coded into Geeklog.<br>
    If you followed the above advice and copied over the <tt>admin</tt>
    directory to your theme, you got this file already.</li>
  <li>Two new files <tt>menuitem_last.thtml</tt> and
    <tt>menuitem_none.thtml</tt> have been added to give theme authors better
    control over the items in menu bars ({menu_elements} and {plg_menu_elements}
    variables in <tt>header.thtml</tt>). The template file
    <tt>menuitem.thtml</tt> is now used to render the first and any following
    menu items - with the exception of the last menu item, which is rendered
    using <tt>menuitem_last.thtml</tt>. If there are no menu elements for a
    menu bar, <tt>menuitem_none.thtml</tt> is used.</li>
  <li>New files have been added and the existing files have been changed for
    the links section (<tt>links</tt> directory). Again, we recommend to just
    copy over those files from one of the themes that ship with Geeklog.<br>
    The new files are: <tt>categoryactivecol.thtml</tt>,
    <tt>categorycol.thtml</tt>, <tt>categorynavigation.thtml</tt>,
    <tt>categoryrow.thtml</tt>, <tt>pagenavigation.thtml</tt></li>
  <li>The user profile has been extended to include a list of the last 10
    stories as well as the total numbers of stories and comments posted by that
    user. Have a look at the file <tt>users/profile.thtml</tt> to see the
    changes or just copy that file over from one of the themes that ship with
    Geeklog. You should also copy over the file <tt>users/storyrow.thtml</tt>
    which describes the block for the last 1o stories.</li>
  <li>The Classic theme has been updated to have an "Edit" link (for
    StoryAdmins) in every story now.<br>
    Files changed: <tt>storybodytext.thtml</tt>,
    <tt>featuredstorybodytext.thtml</tt></li>
  <li>In the Classic and Digital Monochrome themes the "contact" link now
    points to the form to send an email to the admin user instead of using a
    <code>mailto:</code> link with the site's email address from
    <tt>config.php</tt>.</li>
</ul>

<h3>CSS changes</h3>
<ul>
<li>The underscore '_' is not a valid character in CSS. Therefore, some class names used by the Geeklog calendar have been changed to use the dash '-' instead. You may need to change your stylesheet accordingly.<br>
Names that changed: <b>cal-oldday</b>, <b>cal-today</b>,
<b>cal-futureday</b>, <b>cal-nullday</b>, <b>weekview-curday</b>,
<b>weekview-offday</b></li>
<li>A new class named <b>pagenav</b> can be used to format the paged
  navigation.<br>
  Please note that this change was made <em>after</em> the release of Geeklog
  1.3.6rc1 and affects the use of the paged navigation in
  <tt>admin/user/userslist.thtml</tt> and <tt>links/links.thtml</tt>: In
  1.3.6rc1, the navigation was wrapped in &lt;p&gt; tags in those files. As
  of Geeklog 1.3.6 however, the function producing the navigation will wrap
  it in a &lt;div&gt; automatically.</li>
</ul>

<p><strong>Note:</strong> Theme authors are encouraged to specify a character
set in the <tt>header.thtml</tt> of their themes like this:</p>
<blockquote><code>
&lt;meta http-equiv="Content-Type" content="text/html; charset={charset}"&gt;
</code></blockquote>
<p>Geeklog will replace the <code>{charset}</code> variable with the proper
character set based on the currently used language file. Also make sure that
you put the above line <em>before</em> the <code>&lt;title&gt;</code> tag in
the <code>&lt;head&gt;</code> section of your <tt>header.thtml</tt> file.</p>

<table border="0" width="100%" class="footer">
<tr valign="top">
  <td colspan="2"><a href="http://geeklog.sf.net">The Geeklog Documentation Project</a><br>
    All trademarks and copyrights on this page are owned by their respective owners. GeekLog is copyleft.</td>
</tr>
</table>

</body>
</html>
